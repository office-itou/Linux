mmdebstrap:
# aptopts:
#   - "Apt::Install-Recommends true"
# architectures:
#   - amd64
  components:
    - "main contrib non-free non-free-firmware"
# dpkgopts:
# hostname:
# install-recommends:
# keyrings:
#   - /home/master/share/keys
# mirrors:
#   - http://deb.debian.org/debian
  mode: sudo
  packages:
# --- live base ---------------------------------------------------------------
    - live-boot                                             # Live System Boot Components
    - live-config                                           # Live System Configuration Components
    - live-tools                                            # Live System Extra Components
#   - open-infrastructure-system-boot                       # Boot Debian-based system images
#   - open-infrastructure-system-config                     # Configure Debian-based system images
#   - open-infrastructure-system-images                     # Debian-based system images
# --- live base [ debian linux image ] ----------------------------------------
    - linux-image-amd64                                     # Linux for 64-bit PCs (meta-package)
# --- live base [ firmware ] --------------------------------------------------
    - amd64-microcode                                       # Platform firmware and microcode for AMD CPUs and SoCs
    - intel-microcode                                       # Processor microcode firmware for Intel CPUs
    - firmware-linux                                        # Binary firmware for various drivers in the Linux kernel (metapackage)
    - firmware-linux-nonfree                                # Binary firmware for various drivers in the Linux kernel (metapackage)
    - firmware-linux-free                                   # Binary firmware for various drivers in the Linux kernel
    - firmware-sof-signed                                   # Intel SOF firmware - signed
    - i965-va-driver                                        # VAAPI driver for Intel G45 & HD Graphics family
    - intel-media-va-driver                                 # VAAPI driver for the Intel GEN8+ Graphics family
    - mesa-va-drivers                                       # Mesa VA-API video acceleration drivers
    - mesa-vdpau-drivers                                    # Mesa VDPAU video acceleration drivers
    - mesa-vulkan-drivers                                   # Mesa Vulkan graphics drivers
# --- dosfstools --------------------------------------------------------------
    - dosfstools                                            # utilities for making and checking MS-DOS FAT filesystems
# --- exfat-fuse --------------------------------------------------------------
    - exfat-fuse                                            # read and write exFAT driver for FUSE
    - exfatprogs                                            # exFAT file system utilities
# --- ntfs-3g -----------------------------------------------------------------
    - ntfs-3g                                               # read/write NTFS driver for FUSE
# --- lvm2 --------------------------------------------------------------------
    - lvm2                                                  # Linux Logical Volume Manager
#   - thin-provisioning-tools                               # Tools for handling thinly provisioned device-mapper meta-data
# --- mdadm -------------------------------------------------------------------
    - mdadm                                                 # Tool to administer Linux MD arrays (software RAID)
#   - finalrd                                               # 
# --- open-vm-tools -----------------------------------------------------------
    - open-vm-tools                                         # Open VMware Tools for virtual machines hosted on VMware (CLI)
    - open-vm-tools-desktop                                 # Open VMware Tools for virtual machines hosted on VMware (GUI)
#   - cloud-init                                            # initialization system for infrastructure cloud instances
    - fuse3                                                 # Filesystem in Userspace (3.x version)
    - xauth                                                 # X authentication utility
    - xdg-utils                                             # desktop integration utilities from freedesktop.org
# --- base system -------------------------------------------------------------
    - alsa-topology-conf                                    # ALSA topology configuration files
    - alsa-ucm-conf                                         # ALSA Use Case Manager configuration files
#   - apparmor                                              # user-space parser utility for AppArmor
    - apt-utils                                             # package management related utility programs
#   - at-spi2-core                                          # Assistive Technology Service Provider Interface (D-Bus core)
#   - bluez                                                 # Bluetooth tools and daemons
#   - bsdextrautils                                         # extra utilities from 4.4BSD-Lite
#   - ca-certificates                                       # Common CA certificates
#   - connman                                               # Intel Connection Manager daemon
#   - console-data                                          # keymaps, fonts, charset maps, fallback tables for 'kbd'.
    - console-setup                                         # console font and keymap setup program
#   - console-setup-linux                                   # Linux specific part of console-setup
    - cron                                                  # process scheduling daemon
#   - cron-daemon-common                                    # process scheduling daemon's configuration files
    - cryptsetup                                            # disk encryption support - startup scripts
#   - curlftpfs                                             # 
    - dbus                                                  # simple interprocess messaging system (system message bus)
    - dbus-user-session                                     # simple interprocess messaging system (systemd --user integration)
    - dbus-x11                                              # simple interprocess messaging system (X11 deps)
#   - debconf-i18n                                          # full internationalization support for debconf
#   - debian-installer-launcher                             # Debian Installer desktop launcher
    - desktop-base                                          # common files for the Debian Desktop
#   - dirmngr                                               # GNU privacy guard - network certificate management service
#   - dmidecode                                             # SMBIOS/DMI table decoder
    - eject                                                 # ejects CDs and operates CD-Changers under Linux
    - ethtool                                               # display or change Ethernet device settings
#   - fakeroot                                              # tool for simulating superuser privileges
#   - fbterm                                                # fast framebuffer based terminal emulator for Linux
    - fdisk                                                 # collection of partitioning utilities
    - file                                                  # Recognize the type of data in a file using "magic" numbers
    - fontconfig-config                                     # generic font configuration library - configuration
    - fonts-dejavu-core                                     # Vera font family derivate with additional characters
    - fonts-unifont                                         # TrueType version of GNU Unifont
    - gettext-base                                          # GNU Internationalization utilities for the base system
    - gir1.2-dbusmenu-glib-0.4                              # typelib file for libdbusmenu-glib4
    - gnupg                                                 # GNU privacy guard - a free PGP replacement
    - gnupg-l10n                                            # GNU privacy guard - localization files
#   - gnupg-utils                                           # GNU privacy guard - utility programs
#   - gpg                                                   # GNU Privacy Guard -- minimalist public key operations
#   - gpg-agent                                             # GNU privacy guard - cryptographic agent
#   - gpg-wks-client                                        # GNU privacy guard - Web Key Service client
#   - gpg-wks-server                                        # GNU privacy guard - Web Key Service server
#   - gpgconf                                               # GNU privacy guard - core configuration utilities
#   - gpgsm                                                 # GNU privacy guard - S/MIME version
#   - groff-base                                            # GNU troff text-formatting system (base system components)
#   - grub-common                                           # GRand Unified Bootloader (common files)
#   - gsettings-desktop-schemas                             # GSettings desktop-wide schemas
#   - httpfs2                                               # FUSE filesystem for mounting files from http servers
    - ifupdown                                              # high level tools to configure network interfaces
    - init                                                  # metapackage ensuring an init system is installed
    - iproute2                                              # networking and traffic control tools
    - ipset                                                 # administration tool for kernel IP sets
    - iptables                                              # administration tools for packet filtering and NAT
    - iputils-ping                                          # Tools to test the reachability of network hosts
    - isc-dhcp-client                                       # DHCP client for automatically obtaining an IP address
    - isc-dhcp-common                                       # common manpages relevant to all of the isc-dhcp packages
#   - iso-codes                                             # ISO language, territory, currency, script codes and their translations
    - kbd                                                   # Linux console font and keytable utilities
    - keyboard-configuration                                # system-wide keyboard preferences
    - keyutils                                              # Linux Key Management Utilities
    - laptop-detect                                         # system chassis type checker
    - less                                                  # pager program similar to more
#   - libalgorithm-diff-perl                                # module to find differences between files
#   - libalgorithm-merge-perl                               # Perl module for three-way merge of textual data
#   - libasound2-data                                       # Configuration files and profiles for ALSA drivers
#   - libc-devtools                                         # GNU C Library: Development tools
#   - libfile-fcntllock-perl                                # Perl module for file locking with fcntl(2)
#   - libgdk-pixbuf2.0-bin                                  # GDK Pixbuf library (thumbnailer)
#   - libglib2.0-data                                       # Common files for GLib library
#   - libgtk-3-bin                                          # programs for the GTK graphical user interface library
    - libime-bin                                            # Generic Input Method Implementation (tools)
#   - libldap-common                                        # OpenLDAP common files for libraries
#   - liblockfile-bin                                       # support binaries for and cli utilities based on liblockfile
#   - libmagic-mgc                                          # File type determination library using "magic" numbers (compiled magic file)
#   - libtext-wrapi18n-perl                                 # internationalized substitute of Text::Wrap
    - locales                                               # GNU C Library: National Language (locale) data [support]
    - locales-all                                           # GNU C Library: Precompiled locale data
    - lsb-base                                              # transitional package for Linux Standard Base init script functionality
#   - lsof                                                  # utility to list open files
#   - mailcap                                               # Debian's mailcap system, and support programs
#   - man-db                                                # tools for reading manual pages
    - manpages                                              # Manual pages about using a GNU/Linux system
    - manpages-dev                                          # Manual pages about using GNU/Linux for development
    - manpages-ja                                           # Japanese version of the manual pages (for users)
    - manpages-ja-dev                                       # Japanese version of the manual pages (for developers)
#   - mime-support                                          # transitional package
#   - nano                                                  # small, friendly text editor inspired by Pico
#   - ncurses-term                                          # additional terminal type definitions
#   - nftables                                              # Program to control packet filtering rules by Netfilter project
#   - nkf                                                   # Network Kanji code conversion Filter
#   - ofono                                                 # Mobile telephony stack (daemon)
#   - openssl                                               # Secure Sockets Layer toolkit - cryptographic utility
#   - os-prober                                             # utility to detect other OSes on a set of drives
    - pciutils                                              # PCI utilities
#   - pinentry-curses                                       # curses-based PIN or pass-phrase entry dialog for GnuPG
#   - plymouth                                              # boot animation, logger and I/O multiplexer
#   - plymouth-label                                        # boot animation, logger and I/O multiplexer - label control
#   - plymouth-themes                                       # boot animation, logger and I/O multiplexer - themes
#   - plymouth-theme-ubuntu-text                            # 
#   - plymouth-x11                                          # boot animation, logger and I/O multiplexer - X11 renderer
    - psf-unifont                                           # PSF (console) version of GNU Unifont with APL support
#   - publicsuffix                                          # accurate, machine-readable list of domain name suffixes
#   - python3-certifi                                       # root certificates for validating SSL certs and verifying TLS hosts (python3)
#   - python3-chardet                                       # Universal Character Encoding Detector (Python3)
#   - python3-click                                         # Wrapper around optparse for command line utilities - Python 3.x
#   - python3-colorama                                      # Cross-platform colored terminal text in Python - Python 3.x
#   - python3-cryptography                                  # Python library exposing cryptographic recipes and primitives (Python 3)
#   - python3-idna                                          # Python IDNA2008 (RFC 5891) handling (Python 3)
#   - python3-pkg-resources                                 # Package Discovery and Resource Access using pkg_resources
#   - python3-six                                           # Python 2 and 3 compatibility library
    - rsync                                                 # fast, versatile, remote (and local) file-copying tool
    - shellcheck                                            # lint tool for shell scripts
#   - ssl-cert                                              # simple debconf wrapper for OpenSSL
    - sudo                                                  # Provide limited super user privileges to specific users
    - task-japanese                                         # Japanese environment
    - thermald                                              # Thermal monitoring and controlling daemon
    - tree                                                  # displays an indented directory tree, in color
    - unifont                                               # font with a glyph for each visible Unicode Plane 0 character
    - usbutils                                              # Linux USB utilities
    - user-setup                                            # Set up initial user and password
#   - usr-is-merged                                         # Transitional package to assert a merged-/usr system
    - uuid-runtime                                          # runtime components for the Universally Unique ID library
#   - vim-tiny                                              # Vi IMproved - enhanced vi editor - compact version
#   - wamerican                                             # American English dictionary words for /usr/share/dict
    - wget                                                  # retrieves files from the web
    - whiptail                                              # Displays user-friendly dialog boxes from shell scripts
#   - wpasupplicant                                         # client support for WPA and WPA2 (IEEE 802.11i)
#   - x11-xkb-utils                                         # X11 XKB utilities
#   - xcvt                                                  # VESA CVT standard timing modelines generator
#   - xdg-user-dirs                                         # tool to manage well known user directories
    - xfonts-base                                           # standard fonts for X
    - xfonts-encodings                                      # Encodings for X.Org fonts
    - xfonts-unifont                                        # PCF (bitmap) version of GNU Unifont
    - xfonts-utils                                          # X Window System font utility programs
    - xserver-xorg-video-vmware                             # X.Org X server -- VMware display driver
    - xxd                                                   # tool to make (or reverse) a hex dump
    - zerofree                                              # zero free blocks from ext2, ext3 and ext4 file-systems
    - zstd                                                  # fast lossless compression algorithm -- CLI tool
# --- server base [ installed ] -----------------------------------------------
    - apt-transport-https                                   # transitional package for https support
    - firewalld                                             # dynamically managed firewall with support for network zones
    - traceroute                                            # Traces the route taken by packets over an IPv4/IPv6 network
    - connman                                               # Intel Connection Manager daemon
#   - netplan.io                                            # YAML network configuration abstraction for various backends
#   - network-manager                                       # network management framework (daemon and userspace tools)
    - bash-completion                                       # programmable completion for the bash shell
    - build-essential                                       # Informational list of build-essential packages
    - curl                                                  # command line tool for transferring data with URL syntax
    - vim                                                   # Vi IMproved - enhanced vi editor
    - bc                                                    # GNU bc arbitrary precision calculator language
    - clamav                                                # anti-virus utility for Unix - command-line interface
    - openssh-server                                        # secure shell (SSH) server, for secure access from remote machines
    - dnsmasq                                               # Small caching DNS proxy and DHCP/TFTP server
    - tftpd-hpa                                             # HPA's tftp server
    - bind9-dnsutils                                        # Clients provided with BIND 9
    - apache2                                               # Apache HTTP Server
    - samba                                                 # SMB/CIFS file, print, and login server for Unix
    - smbclient                                             # command-line SMB/CIFS clients for Unix
    - cifs-utils                                            # Common Internet File System utilities
    - libnss-winbind                                        # Samba nameservice integration plugins
# --- desktop base [ installed ] ----------------------------------------------
    - task-desktop                                          # Debian desktop environment
    - task-lxde-desktop                                     # LXDE
    - task-laptop                                           # laptop
    - task-japanese                                         # Japanese environment
    - task-japanese-desktop                                 # Japanese desktop
    - fonts-noto                                            # metapackage to pull in all Noto fonts
    - im-config                                             # Input method configuration framework
    - fcitx5-mozc                                           # Mozc engine for fcitx5 - Client of the Mozc input method
    - mozc-utils-gui                                        # GUI utilities of the Mozc input method
    - gnome-shell-extensions                                # Extensions to extend functionality of GNOME Shell
    - libreoffice-l10n-ja                                   # office productivity suite -- Japanese language package
    - libreoffice-help-ja                                   # office productivity suite -- Japanese help
    - firefox-esr-l10n-ja                                   # Japanese language package for Firefox ESR
    - thunderbird                                           # mail/news client with RSS, chat and integrated spam filter support
    - thunderbird-l10n-ja                                   # Japanese language package for Thunderbird
# --- desktop base [ display manager ] ----------------------------------------
#   - gdm3                                                  # GNOME Display Manager
    - lightdm                                               # simple display manager
# --- desktop base [ dependencies ] -------------------------------------------
#   - acl                                                   # access control list - utilities
    - alsa-utils                                            # Utilities for configuring and using ALSA
    - connman-gtk                                           # fully-featured GUI for ConnMan with systray support
#   - gstreamer1.0-alsa                                     # GStreamer plugin for ALSA
    - fcitx5-config-qt                                      # configuration tool for Fcitx5 (Qt version)
#   - fcitx5-frontend-all                                   # Fcitx Input Method Framework v5 (IM Module Metapackage)
#   - fcitx5-frontend-gtk2                                  # GTK2 IM Module for fcitx5
#   - fcitx5-frontend-gtk3                                  # GTK3 IM Module for fcitx5
#   - fcitx5-frontend-gtk4                                  # GTK4 IM Module for fcitx5
#   - fcitx5-frontend-qt5                                   # Qt5 IM module for fcitx5
#   - fcitx5-frontend-qt6                                   # Qt6 IM module for fcitx5
    - fonts-ipafont                                         # Japanese OpenType font set (Mincho and Gothic)
    - fonts-noto-cjk                                        # "No Tofu" font families with large Unicode coverage (CJK regular and bold)
    - fonts-noto-cjk-extra                                  # "No Tofu" font families with large Unicode coverage (CJK all weight)
    - fonts-noto-color-emoji                                # color emoji font from Google
    - fonts-noto-extra                                      # "No Tofu" font families with large Unicode coverage (extra)
    - fonts-noto-mono                                       # "No Tofu" monospaced font family with large Unicode coverage
    - fonts-noto-ui-core                                    # "No Tofu" font families with large Unicode coverage (UI core)
    - fonts-noto-ui-extra                                   # "No Tofu" font families with large Unicode coverage (UI extra)
    - fonts-noto-unhinted                                   # "No Tofu" font families with large Unicode coverage (unhinted)
    - fonts-symbola                                         # symbolic font providing emoji characters from Unicode 9.0
    - fonts-vlgothic                                        # Japanese TrueType font from Vine Linux
#   - i965-va-driver                                        # VAAPI driver for Intel G45 & HD Graphics family
    - ibus                                                  # Intelligent Input Bus - core
    - ibus-gtk                                              # Intelligent Input Bus - GTK2 support
    - ibus-gtk3                                             # Intelligent Input Bus - GTK3 support
    - ibus-gtk4                                             # Intelligent Input Bus - GTK4 support
    - ibus-table                                            # table engine for IBus
#   - intel-media-va-driver                                 # VAAPI driver for the Intel GEN8+ Graphics family
    - jq                                                    # lightweight and flexible command-line JSON processor
    - libfastjson4                                          # fast json library for C
    - libjson-c5                                            # JSON manipulation library - shared library
    - libjson-glib-1.0-0                                    # GLib JSON manipulation library
    - libjson-glib-1.0-common                               # GLib JSON manipulation library (common files)
    - libpam-gnome-keyring                                  # PAM module to unlock the GNOME keyring upon login
    - libpam-sss                                            # Pam module for the System Security Services Daemon
#   - mesa-vulkan-drivers                                   # Mesa Vulkan graphics drivers
    - orca                                                  # Scriptable screen reader
    - pavucontrol                                           # PulseAudio Volume Control
    - power-profiles-daemon                                 # Makes power profiles handling available over D-Bus.
    - powermgmt-base                                        # common utils for power management
    - pulseaudio                                            # PulseAudio sound server
    - pulseaudio-utils                                      # Command line tools for the PulseAudio sound server
#   - qtwayland5                                            # QtWayland platform plugin
    - rtkit                                                 # Realtime Policy and Watchdog Daemon
    - upower                                                # abstraction for power management
    - xdg-user-dirs-gtk                                     # tool to manage well known user directories (Gtk extension)
#   - xmms2-core                                            # XMMS2 - core package
#   - xmms2-plugin-alsa                                     # XMMS2 - ALSA output
# --- xserver -----------------------------------------------------------------
    - x11-apps                                              # X applications
    - x11-common                                            # X Window System (X.Org) infrastructure
    - x11-session-utils                                     # X session utilities
    - x11-utils                                             # X11 utilities
    - x11-xkb-utils                                         # X11 XKB utilities
    - x11-xserver-utils                                     # X server utilities
    - xcvt                                                  # VESA CVT standard timing modelines generator
    - xscreensaver                                          # Screensaver daemon and frontend for X11
#   - xscreensaver-data-extra                               # Extra screen saver modules for screensaver frontends
#   - xscreensaver-gl                                       # GL(Mesa) screen saver modules for screensaver frontends
#   - xscreensaver-gl-extra                                 # Extra GL(Mesa) screen saver modules for screensaver frontends
#   - xscreensaver-screensaver-bsod                         # BSOD screen saver module from XScreenSaver
#   - xscreensaver-screensaver-dizzy                        # Graphics demo that makes you dizzy (XScreenSaver hack)
#   - xscreensaver-screensaver-webcollage                   # Webcollage screen saver module from XScreenSaver
    - xserver-xephyr                                        # nested X server
    - xserver-xorg-legacy                                   # setuid root Xorg server wrapper
    - xserver-xorg-video-intel                              # X.Org X server -- Intel i8xx, i9xx display driver
    - xserver-xorg-video-nouveau                            # X.Org X server -- Nouveau display driver
#   - xserver-xorg-video-qxl                                # X.Org X server -- QXL display driver
# --- gnome -------------------------------------------------------------------
#   - gnome-accessibility-themes                            # High Contrast GTK+ 2 theme and icons
#   - gnome-brave-icon-theme                                # blue variation of the GNOME-Colors icon theme
#   - gnome-colors                                          # set of GNOME icon themes
#   - gnome-colors-common                                   # common icons for all GNOME-Colors icon themes
#   - gnome-desktop3-data                                   # Common files for GNOME desktop apps
    - gnome-disk-utility                                    # manage and configure disk drives and media
#   - gnome-dust-icon-theme                                 # chocolate variation of the GNOME-Colors icon theme
#   - gnome-human-icon-theme                                # orange variation of the GNOME-Colors icon theme
#   - gnome-icon-theme                                      # GNOME Desktop icon theme
#   - gnome-illustrious-icon-theme                          # pink variation of the GNOME-Colors icon theme
    - gnome-keyring                                         # GNOME keyring services (daemon and tools)
    - gnome-keyring-pkcs11                                  # GNOME keyring module for the PKCS#11 module loading library
#   - gnome-noble-icon-theme                                # purple variation of the GNOME-Colors icon theme
    - gnome-power-manager                                   # power management tool for the GNOME desktop
    - gnome-remote-desktop                                  # Remote desktop daemon for GNOME using PipeWire
#   - gnome-screenshot                                      # screenshot application for GNOME
#   - gnome-system-tools                                    # Cross-platform configuration utilities
    - gnome-terminal                                        # GNOME terminal emulator application
    - gnome-text-editor                                     # simple text editor for GNOME
#   - gnome-themes-extra                                    # Adwaita GTK+ 2 theme — engine
#   - gnome-themes-extra-data                               # Adwaita GTK+ 2 theme — common files
#   - gnome-wine-icon-theme                                 # red variation of the GNOME-Colors icon theme
#   - gnome-wise-icon-theme                                 # green variation of the GNOME-Colors icon theme
# --- gvfs --------------------------------------------------------------------
    - gvfs                                                  # userspace virtual filesystem - GIO module
    - gvfs-backends                                         # userspace virtual filesystem - backends
    - gvfs-common                                           # userspace virtual filesystem - common data files
    - gvfs-daemons                                          # userspace virtual filesystem - servers
    - gvfs-fuse                                             # userspace virtual filesystem - fuse server
    - gvfs-libs                                             # userspace virtual filesystem - private libraries
# --- chromium ---------------------------------------------------------------
    - chromium                                              # web browser
    - chromium-l10n                                         # web browser - language packs
# --- libreoffice -------------------------------------------------------------
    - libreoffice-base                                      # office productivity suite -- database
    - libreoffice-calc                                      # office productivity suite -- spreadsheet
    - libreoffice-core                                      # office productivity suite -- arch-dependent files
    - libreoffice-draw                                      # office productivity suite -- drawing
    - libreoffice-impress                                   # office productivity suite -- presentation
    - libreoffice-math                                      # office productivity suite -- equation editor
    - libreoffice-report-builder-bin                        # LibreOffice component for building database reports -- libraries
    - libreoffice-writer                                    # office productivity suite -- word processor
# setup-hooks:
# essential-hooks:
  customize-hooks:
    - chroot "$1" usermod --password "$(echo 'password' | openssl passwd -6 -stdin)" root
#   - chroot "$1" passwd --delete root
#   - chroot "$1" sh -c 'echo "PasswordAuthentication yes\nPermitRootLogin no" > /etc/ssh/sshd_config.d/sshd.conf'
#   - chroot "$1" sh -c 'if [ -e /usr/bin/startlxde ]; then update-alternatives --set "x-session-manager" "/usr/bin/startlxde"; update-alternatives --get-selections | grep x-session-manager; fi'
#   - chroot "$1" sh -c 'if [ -d /etc/dconf/. ]; then mkdir -p /etc/dconf/db/local.d /etc/dconf/profile; echo "user-db:user\nsystem-db:local" > /etc/dconf/profile/user; echo "[org/gnome/desktop/session]\nidle-delay="uint32 0"\n\n[org/gnome/desktop/interface]\ncursor-theme=\"Adwaita\"\nicon-theme=\"Adwaita\"\ngtk-theme=\"Adwaita\"\n\n" > /etc/dconf/db/local.d/01-userkeyfile; dconf compile /etc/dconf/db/local /etc/dconf/db/local.d; rm /etc/dconf/db/local.d/01-userkeyfile; fi'
#   - chroot "$1" sh -c '_RETURN_VALUE="$(dpkg-query --show fcitx5 2> /dev/null)"; if [ -n "${_RETURN_VALUE:-}" ]; then im-config -n fcitx5; fi'
#   - chroot "$1" sh -c '_RETURN_VALUE="$(dpkg-query --show fcitx5 2> /dev/null)"; if [ -n "${_RETURN_VALUE:-}" ]; then sed -i -e '\''/^IM_CONFIG_DEFAULT_MODE=/ s/=.*$/=fcitx5/'\'' /etc/default/im-config; fi'
    - chroot "$1" sh -c '_RETURN_VALUE="$(dpkg-query --show samba 2> /dev/null)"; if [ -n "${_RETURN_VALUE:-}" ]; then sed -i -e '\''/hosts:/{'\'' -e '\''/wins/! s/$/ wins/}'\'' /etc/nsswitch.conf; fi'
    - chroot "$1" sh -c '_RETURN_VALUE="$(dpkg-query --show lightdm 2> /dev/null)"; if [ -n "${_RETURN_VALUE:-}" ]; then dpkg-reconfigure --no-reload lightdm; fi'
    - chroot "$1" sh -c '_UNITS="firewalld.service clamav-freshclam.service dnsmasq.service tftpd-hpa.service apache2.service"; _PARM="$(echo "${_UNITS}" | sed -e '\''s/ /|/g'\'')"; _RETURN_VALUE="$(systemctl list-unit-files ${_UNITS} | awk '\''$0~/'\''"${_PARM}"'\''/ {print $1;}'\'')"; if [ -n "${_RETURN_VALUE:-}" ]; then systemctl disable ${_RETURN_VALUE}; fi'
    - chroot "$1" sh -c '_UNITS="ssh.service smbd.service nmbd.service"; _PARM="$(echo "${_UNITS}" | sed -e '\''s/ /|/g'\'')"; _RETURN_VALUE="$(systemctl list-unit-files ${_UNITS} | awk '\''$0~/'\''"${_PARM}"'\''/ {print $1;}'\'')"; if [ -n "${_RETURN_VALUE:-}" ]; then systemctl enable ${_RETURN_VALUE}; fi'
#   - chroot "$1" sh -c '_RETURN_VALUE="$(command -v snap 2> /dev/null)"; if [ -n "${_RETURN_VALUE:-}" ]; then snap install firefox chromium; fi'
#   - chroot "$1" firewall-cmd --permanent --change-interface=ens160 --zone=home
  cleanup-hooks:
    - rm -f "$1/etc/hostname" "$1/etc/hosts"
    - P="$1"; for D in $(mount | awk '$3~"'$P'" { print $3;}' | sort -r); do umount "${D}" || umount --force "${D}" || umount --lazy "${D}"; done
# suite:
# target: filesystem.squashfs
# variant: extract                      # Installs nothing by default (not even "Essential:yes" packages). Packages given by the "--include" option are extracted but will not be installed.
# variant: custom                       # Installs nothing by default (not even "Essential:yes" packages). Packages given by the "--include" option will be installed.
# variant: essential                    # "Essential:yes" packages.
# variant: apt                          # The essential set plus apt.
# variant: required                     # The essential set plus all packages with Priority:required and apt.
  variant: minbase                      # "
# variant: buildd                       # The minbase set plus build-essential.
# variant: important                    # The required set plus all packages with Priority:important.
# variant: debootstrap                  # "
# variant: -                            # "
# variant: standard                     # The important set plus all packages with Priority:standard.
